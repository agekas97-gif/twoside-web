<!DOCTYPE html>

<html lang="lt" style="scroll-behavior: smooth;">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>TwoSide RP | Modernus Serveris</title>

    

    <link rel="icon" href="logo.png">

    <meta property="og:title" content="TwoSide RP | Modernus Serveris">

    <meta name="theme-color" content="#0070f3">



    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    

    <style>

        :root { 

            --blue: #0070f3; 

            --bg: #050505; 

            --glass: rgba(20, 20, 20, 0.65); 

            --border: rgba(255, 255, 255, 0.08); 

            --text-main: #ffffff; 

            --text-dim: #999999;

            --success: #00e676; 

            --danger: #ff1744; 

            --gold: #ffd700; 

        }

        

        ::-webkit-scrollbar { width: 6px; } 

        ::-webkit-scrollbar-track { background: #000; } 

        ::-webkit-scrollbar-thumb { background: var(--blue); border-radius: 10px; }

        

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; -webkit-tap-highlight-color: transparent; }

        body { background-color: var(--bg); color: var(--text-main); min-height: 100vh; overflow-x: hidden; position: relative; }

        

        #bg-video { position: fixed; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: -1; filter: brightness(0.3) blur(2px); }

        #particles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; }

        .particle { position: absolute; background: rgba(255, 255, 255, 0.5); border-radius: 50%; animation: float 20s infinite linear; }

        @keyframes float { 0% { transform: translateY(0) translateX(0); opacity: 0; } 100% { transform: translateY(-100vh) translateX(50px); opacity: 0; } }

        

        /* --- MODERNUS STIKLO DIZAINAS (GLASSMORPHISM) --- */

        .glass-card, .rule-card, .vip-card, .admin-app-card {

            background: var(--glass);

            backdrop-filter: blur(16px);

            -webkit-backdrop-filter: blur(16px);

            border: 1px solid var(--border);

            border-radius: 24px;

            padding: 40px;

            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);

            transition: all 0.3s ease;

            position: relative;

            overflow: hidden;

        }



        /* Hover efektai kortelėms */

        .rule-card:hover, .vip-card:hover {

            transform: translateY(-5px);

            border-color: var(--blue);

            box-shadow: 0 15px 40px rgba(0, 112, 243, 0.2);

        }

        

        .admin-mode-card { border-top: 2px solid red !important; box-shadow: 0 0 50px rgba(255, 0, 0, 0.15) !important; }



        /* NAVIGACIJA */

        nav { position: fixed; top: 0; width: 100%; padding: 20px 50px; display: flex; justify-content: space-between; align-items: center; backdrop-filter: blur(15px); z-index: 1000; border-bottom: 1px solid var(--border); background: rgba(0,0,0,0.7); transition: 0.3s; }

        .logo { font-weight: 800; font-size: 1.5rem; display: flex; align-items: center; gap: 10px; color: white; }

        .logo span { color: var(--blue); }

        .status-dot { width: 10px; height: 10px; background-color: #00ff88; border-radius: 50%; box-shadow: 0 0 10px #00ff88; animation: pulse 2s infinite; }

        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.3); opacity: 0.6; } }

        

        .nav-right { display: flex; align-items: center; gap: 40px; }

        .nav-links { display: flex; gap: 30px; }

        .nav-links a { color: #ccc; cursor: pointer; font-weight: 700; font-size: 0.9rem; position: relative; transition: 0.3s; text-decoration: none; }

        .nav-links a:hover, .nav-links a.active { color: #fff; text-shadow: 0 0 15px rgba(255,255,255,0.5); }

        

        /* Judanti linija po meniu */

        .nav-links a::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -5px; left: 0; background: var(--blue); transition: 0.3s; box-shadow: 0 0 10px var(--blue); }

        .nav-links a:hover::after, .nav-links a.active::after { width: 100%; }



        /* MYGTUKAI */

        .btn-hero { 

            padding: 14px 35px; border-radius: 12px; font-weight: 800; border: none; cursor: pointer; transition: all 0.3s ease; 

            background: linear-gradient(135deg, var(--blue), #0050b3); color: white; display: inline-flex; align-items: center; gap: 10px;

            text-transform: uppercase; letter-spacing: 1px; font-size: 0.9rem;

        }

        .btn-hero:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(0, 112, 243, 0.4); }

        

        #discord-btn { background: #5865F2; }

        #discord-btn:hover { background: #4752c4; box-shadow: 0 10px 30px rgba(88, 101, 242, 0.4); }



        /* PAGRINDINIS */

        .main-wrapper { max-width: 1200px; margin: 0 auto; padding-top: 100px; padding-bottom: 100px; width: 90%; }

        section { min-height: auto; margin-bottom: 80px; scroll-margin-top: 120px; }

        

        h1 { font-size: 4rem; font-weight: 900; line-height: 1; margin-bottom: 20px; letter-spacing: -2px; }

        .blue-gradient { background: linear-gradient(135deg, #fff 30%, var(--blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        

        .dash-grid, .vip-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-top: 30px; }

        

        .rule-card i, .vip-card i { font-size: 2rem; color: var(--blue); margin-bottom: 15px; }

        .rule-card h4 { font-size: 1.4rem; font-weight: 800; margin-bottom: 5px; }

        .rule-card p { color: var(--text-dim); font-size: 0.9rem; }



        /* MODERN ADMIN UI */

        .toggle-btn {

            width: 100%; padding: 12px; margin-top: 15px;

            background: rgba(255, 255, 255, 0.05);

            border: 1px solid rgba(255, 255, 255, 0.1);

            color: #ccc; font-weight: 700; font-size: 0.8rem;

            border-radius: 8px; cursor: pointer; transition: 0.3s;

            text-transform: uppercase; letter-spacing: 1px;

            display: flex; justify-content: center; align-items: center; gap: 8px;

        }

        .toggle-btn:hover { background: var(--blue); color: white; border-color: var(--blue); box-shadow: 0 0 15px rgba(0, 112, 243, 0.4); }

        

        .admin-nav-btn {

            background: rgba(255,255,255,0.03); border: 1px solid var(--border); padding: 15px;

            text-align: left; border-radius: 12px; color: #ccc; font-weight: 600; cursor: pointer;

            display: flex; align-items: center; gap: 10px; transition: 0.3s; margin-bottom: 10px;

        }

        .admin-nav-btn:hover, .admin-nav-btn.active { background: rgba(0, 112, 243, 0.15); color: var(--blue); border-color: var(--blue); }

        

        .admin-app-card { background: rgba(255,255,255,0.03); padding: 20px; border-radius: 15px; margin-bottom: 15px; border-left: 4px solid var(--blue); }

        

        /* LOADER */

        #preloader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: flex; justify-content: center; align-items: center; transition: 0.5s; flex-direction: column; }

        #preloader.hidden { opacity: 0; pointer-events: none; }

        .admin-load-text { color: var(--danger) !important; text-shadow: 0 0 20px red; }



        /* FORMOS */

        .input-group { margin-bottom: 20px; }

        label { display: block; margin-bottom: 8px; font-weight: 700; color: #ccc; }

        input, textarea { width: 100%; background: rgba(0,0,0,0.3); border: 1px solid var(--border); padding: 15px; border-radius: 12px; color: white; outline: none; transition: 0.3s; font-size: 1rem; }

        input:focus, textarea:focus { border-color: var(--blue); background: rgba(0, 112, 243, 0.05); }

        

        /* MODAL */

        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; align-items: center; justify-content: center; backdrop-filter: blur(8px); }

        .modal-overlay.open { display: flex; animation: fadeIn 0.3s; }

        .modal-content { background: #0f0f0f; border: 1px solid var(--border); border-radius: 25px; padding: 40px; width: 90%; max-width: 600px; position: relative; box-shadow: 0 0 50px rgba(0,0,0,0.5); }

        

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }



        @media (max-width: 768px) {

            nav { padding: 20px; flex-direction: column; height: auto; background: rgba(0,0,0,0.95); }

            .nav-right, .nav-links { flex-direction: column; gap: 15px; width: 100%; text-align: center; }

            .nav-links a { display: block; padding: 10px; }

            h1 { font-size: 3rem; }

            .admin-layout { flex-direction: column; }

            .admin-sidebar { width: 100%; border-right: none; margin-bottom: 20px; }

        }

    </style>

</head>

<body>



    <div id="preloader">

        <h1 style="font-size: 3rem; font-weight: 900;" id="loaderText">TWOSIDE<span style="color:var(--blue)">.LT</span></h1>

    </div>



    <div id="particles"></div>

    <video autoplay muted loop playsinline id="bg-video"><source src="https://static.videezy.com/system/resources/previews/000/042/179/original/Traffic_lights_timelapse.mp4" type="video/mp4"></video>



    <nav>

        <div class="logo"><div class="status-dot"></div><div>TWOSIDE<span>.LT</span></div></div>

        <div class="nav-right">

            <div class="nav-links">

                <a onclick="scrollToSection('home')" id="link-home" class="active">PAGRINDINIS</a>

                <a onclick="scrollToSection('about')" id="link-about">APRAŠYMAS</a>

                <a onclick="scrollToSection('rules')" id="link-rules">TAISYKLĖS</a>

            </div>

            <div id="auth-container">

                <button id="discord-btn" class="btn-hero" onclick="loginWithDiscord()"><i class="fab fa-discord"></i> PRISIJUNGTI</button>

                <div id="user-profile" style="display:none; align-items:center; gap:15px;">

                    <img id="user-avatar" src="" style="width:40px; border-radius:50%; border:2px solid var(--blue);">

                    <span id="user-name" style="font-weight:bold;"></span>

                </div>

            </div>

        </div>

    </nav>



    <div class="main-wrapper">

        

        <section id="dashboard" style="display:none;">

            

            <div class="glass-card" id="dash-card">

                <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:20px;">

                    <div style="display:flex; align-items:center; gap:20px;">

                        <img id="dash-avatar" src="" style="width: 80px; border-radius: 20px; border: 2px solid var(--blue); box-shadow: 0 0 20px rgba(0, 112, 243, 0.4);">

                        <div>

                            <h2 id="dash-welcome" style="margin:0; font-size:2rem;">Sveikas!</h2>

                            <p style="color:var(--text-dim); margin-top:5px;">ID: <span id="dash-id" style="color:white; font-family:monospace;"></span></p>

                        </div>

                    </div>

                    <button onclick="logout()" class="btn-hero" style="background:rgba(220,53,69,0.15); color:#ff4444; border:1px solid #ff4444;">ATSIJUNGTI</button>

                </div>

            </div>



            <div id="admin-area" class="glass-card" style="display:none; border-top: 2px solid var(--danger);">

                <h2 style="color:var(--danger); margin-bottom:25px;"><i class="fas fa-shield-alt"></i> ADMIN PULTAS</h2>

                <div style="display:flex; gap:30px;" class="admin-layout">

                    <div class="admin-sidebar" style="min-width:200px;">

                        <div class="admin-nav-btn active" onclick="switchTab('apps')"><i class="fas fa-list"></i> Anketos</div>

                        <div class="admin-nav-btn" onclick="switchTab('actions')"><i class="fas fa-cogs"></i> Veiksmai</div>

                    </div>

                    <div class="admin-content" style="flex:1;">

                        <div id="tab-apps"><div id="applications-list"><p style="color:#666;">Kraunama...</p></div></div>

                        <div id="tab-actions" style="display:none;">

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">

                                <div class="glass-card" style="padding:20px; text-align:center; cursor:pointer;" onclick="alert('Serveris perkraunamas...')">

                                    <i class="fas fa-redo" style="font-size:2rem; margin-bottom:10px;"></i>

                                    <h4>Perkrauti Serverį</h4>

                                </div>

                            </div>

                        </div>

                    </div>

                </div>

            </div>



            <div id="wl-card" class="glass-card" style="border-top: 2px solid var(--blue); padding:30px;">

                <h3 style="margin-bottom:10px;"><i class="fas fa-id-card"></i> WHITELIST STATUSAS</h3>

                <p id="wl-status-text" style="color:#ccc; margin-bottom:20px; font-size:1.1rem;">Tikrinama...</p>

                <button id="btn-wl-apply" class="btn-hero" onclick="openModal()" style="display:none;">PILDYTI ANKETĄ</button>

            </div>



            <div class="dash-grid">

                <div class="rule-card">

                    <div style="text-align:center;">

                        <i class="fas fa-shield-alt"></i>

                        <h4>Policija</h4>

                        <p id="status-policija" style="color:var(--success);">ATIDARYTA</p>

                    </div>

                    <div class="admin-controls" id="adm-policija">

                        <button class="toggle-btn" onclick="toggleJob('policija')">KEISTI STATUSĄ</button>

                    </div>

                </div>

                <div class="rule-card" style="border-top: 4px solid var(--gold);">

                    <div style="text-align:center;">

                        <i class="fas fa-crown" style="color:var(--gold);"></i>

                        <h4>VIP Narystė</h4>

                        <p>Peržiūrėti planus</p>

                    </div>

                    <button class="toggle-btn" style="background:var(--gold); color:black; border:none;" onclick="openVip()">ATIDARYTI</button>

                </div>

            </div>

        </section>



        <section id="home">

            <div class="glass-card" style="padding: 80px 40px; text-align: left;">

                <div style="display:inline-block; background: rgba(0, 112, 243, 0.15); padding: 8px 20px; border-radius: 30px; color: var(--blue); font-weight: 800; font-size: 0.9rem; margin-bottom: 25px; border: 1px solid var(--blue);">

                    <i class="fas fa-check-circle"></i> SEZONAS 2.0 STARTAVO

                </div>

                <h1 style="font-weight:900;">TWOSIDE <span class="blue-gradient">ROLEPLAY</span></h1>

                <p style="font-size:1.2rem; color:#aaa; max-width:600px; margin-bottom:30px; line-height:1.6;">

                    Prisijunk prie sparčiausiai augančios bendruomenės Lietuvoje. Unikalios sistemos, brandi administracija ir tavo nauja istorija prasideda čia.

                </p>

                <div style="display:flex; gap:15px; flex-wrap:wrap;">

                    <button class="btn-hero" onclick="copyIP()"><i class="fas fa-play"></i> PRISIJUNGTI</button>

                    <a href="https://discord.gg/SyGUUGWqj6" target="_blank" class="btn-hero" style="background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2);"><i class="fab fa-discord"></i> DISCORD</a>

                </div>

            </div>

        </section>



        <section id="about">

            <div class="glass-card">

                <h2 style="font-size: 3rem; margin-bottom: 40px;">KODĖL <span class="blue-gradient">TWOSIDE?</span></h2>

                <div class="dash-grid">

                    <div class="rule-card"><i class="fas fa-tachometer-alt"></i><h4>Optimizuota</h4><p>Serveris kurtas galvojant apie stabilumą.</p></div>

                    <div class="rule-card"><i class="fas fa-users"></i><h4>Bendruomenė</h4><p>Draugiška ir brandi bendruomenė.</p></div>

                    <div class="rule-card"><i class="fas fa-briefcase"></i><h4>Ekonomika</h4><p>Realistiška ekonomika ir darbai.</p></div>

                </div>

            </div>

        </section>



        <section id="rules">

            <div class="glass-card">

                <h2 style="font-size: 3rem; margin-bottom: 40px;">SVARBIAUSIOS <span class="blue-gradient">TAISYKLĖS</span></h2>

                <div class="dash-grid">

                    <div class="rule-card"><h4><i class="fas fa-skull"></i> RDM</h4><p>Žudymas be priežasties draudžiamas.</p></div>

                    <div class="rule-card"><h4><i class="fas fa-car-crash"></i> VDM</h4><p>Trankymas su mašina draudžiamas.</p></div>

                    <div class="rule-card"><h4><i class="fas fa-theater-masks"></i> Power Gaming</h4><p>Neįmanomi veiksmai draudžiami.</p></div>

                </div>

            </div>

        </section>



    </div>



    <div class="modal-overlay" id="appModal">

        <div class="modal-content">

            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">

                <h2 style="margin:0;">WHITELIST ANKETA</h2>

                <i class="fas fa-times" style="cursor:pointer; font-size:1.5rem;" onclick="closeModal()"></i>

            </div>

            <form onsubmit="submitForm(event)">

                <div class="input-group"><label>1. Kiek tau metų?</label><input type="number" id="q1" required placeholder="Pvz: 16"></div>

                <div class="input-group"><label>2. RP Patirtis?</label><textarea id="q2" required placeholder="Tavo patirtis..."></textarea></div>

                <div class="input-group"><label>3. Kas yra NLR?</label><textarea id="q3" required placeholder="Paaiškink..."></textarea></div>

                <div class="input-group"><label>4. Kas yra FEARRP?</label><textarea id="q4" required placeholder="Paaiškink..."></textarea></div>

                <div class="input-group"><label>5. Kodėl mes?</label><textarea id="q5" required placeholder="Kodėl pasirinkai mus?"></textarea></div>

                <button type="submit" class="btn-hero" style="width:100%;">SIŲSTI ANKETĄ</button>

            </form>

        </div>

    </div>



    <div class="modal-overlay" id="vipModal">

        <div class="modal-content" style="max-width:900px;">

            <div style="text-align:right;"><i class="fas fa-times" style="cursor:pointer; font-size:1.5rem;" onclick="closeVip()"></i></div>

            <h2 style="text-align:center; margin-bottom:30px; font-size:2.5rem;">VIP PLANAI</h2>

            <div class="vip-grid">

                <div class="vip-card" style="border-top: 4px solid #cd7f32;">

                    <div style="text-align:center;">

                        <h3 style="color:#cd7f32">BRONZE</h3>

                        <h2 style="font-size:2.5rem;">5€</h2>

                    </div>

                    <ul style="list-style:none; padding:20px 0; text-align:center;">

                        <li>Prioritetinė eilė</li>

                        <li>1 Custom Mašina</li>

                    </ul>

                    <button class="btn-hero" style="width:100%;">PIRKTI</button>

                </div>

                <div class="vip-card" style="border-top: 4px solid #c0c0c0;">

                    <div style="text-align:center;">

                        <h3 style="color:#c0c0c0">SILVER</h3>

                        <h2 style="font-size:2.5rem;">10€</h2>

                    </div>

                    <ul style="list-style:none; padding:20px 0; text-align:center;">

                        <li>Aukštesnė eilė</li>

                        <li>2 Custom Mašinos</li>

                    </ul>

                    <button class="btn-hero" style="width:100%;">PIRKTI</button>

                </div>

            </div>

        </div>

    </div>



    <script>

        // --- SVARBU: TAVO TUNELIO NUORODA ---

        const API_URL = "https://twoside-final-v3.loca.lt";

        

        const CLIENT_ID = "1470568120921100423"; 

        const REDIRECT_URI = "https://twoside.lt";



        let currentUser = null;



        // SCROLL SPY & PARTICLES

        function createParticles() {

            const container = document.getElementById('particles');

            for(let i=0; i<30; i++){

                let p = document.createElement('div');

                p.className = 'particle';

                p.style.left = Math.random()*100 + 'vw';

                p.style.top = Math.random()*100 + 'vh';

                p.style.width = Math.random()*3 + 'px';

                p.style.height = p.style.width;

                p.style.animationDuration = Math.random()*20 + 10 + 's';

                container.appendChild(p);

            }

        }

        createParticles();



        window.addEventListener('scroll', () => {

            let current = "";

            document.querySelectorAll("section").forEach(section => {

                const sectionTop = section.offsetTop;

                if (pageYOffset >= sectionTop - 250) current = section.getAttribute("id");

            });

            document.querySelectorAll(".nav-links a").forEach(li => {

                li.classList.remove("active");

                if (li.id === `link-${current}`) li.classList.add("active");

            });

        });



        function scrollToSection(id) { document.getElementById(id).scrollIntoView({ behavior: 'smooth' }); }

        function loginWithDiscord() { window.location.href = `https://discord.com/api/oauth2/authorize?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=token&scope=identify`; }

        function logout() { localStorage.removeItem('token'); window.location.reload(); }

        function openModal() { document.getElementById('appModal').classList.add('open'); }

        function closeModal() { document.getElementById('appModal').classList.remove('open'); }

        function openVip() { document.getElementById('vipModal').classList.add('open'); }

        function closeVip() { document.getElementById('vipModal').classList.remove('open'); }

        function copyIP() { navigator.clipboard.writeText('connect cfx.re/join/3zv39z'); alert("IP Nukopijuotas!"); }



        function switchTab(tab) {

            document.querySelectorAll('.admin-content > div').forEach(d => d.style.display='none');

            document.getElementById(`tab-${tab}`).style.display='block';

            document.querySelectorAll('.admin-nav-btn').forEach(b => b.classList.remove('active'));

            event.currentTarget.classList.add('active');

        }



        async function init() {

            const fragment = new URLSearchParams(window.location.hash.slice(1));

            let token = fragment.get('access_token') || localStorage.getItem('token');



            if (token) {

                localStorage.setItem('token', token);

                try {

                    const userRes = await fetch('https://discord.com/api/users/@me', { headers: { authorization: `Bearer ${token}` } });

                    const user = await userRes.json();

                    currentUser = user;



                    // UI Updates

                    document.getElementById('discord-btn').style.display = 'none';

                    document.getElementById('user-profile').style.display = 'flex';

                    document.getElementById('user-name').innerText = user.username;

                    document.getElementById('user-avatar').src = `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png`;

                    document.getElementById('dashboard').style.display = 'block';

                    document.getElementById('dash-welcome').innerText = `Sveikas, ${user.username}!`;

                    document.getElementById('dash-id').innerText = user.id;

                    document.getElementById('dash-avatar').src = `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png`;



                    // Check Status from VPS

                    const statusRes = await fetch(`${API_URL}/check-status?id=${user.id}`);

                    const status = await statusRes.json();



                    if (status.isAdmin) {

                        document.getElementById('loaderText').innerHTML = "TWOSIDE <span style='color:red'>ADMIN</span>";

                        document.getElementById('admin-area').style.display = 'block';

                        document.querySelectorAll('.admin-controls').forEach(el => el.classList.add('visible'));

                        document.getElementById('dash-card').classList.add('admin-mode-card');

                        loadApps(user.id);

                    }



                    const wlCard = document.getElementById('wl-card');

                    const wlText = document.getElementById('wl-status-text');

                    const wlBtn = document.getElementById('btn-wl-apply');



                    if (status.isWhitelisted) {

                        wlCard.style.borderTop = "2px solid #00e676";

                        wlText.innerHTML = "✅ <b style='color:#00e676'>JŪS TURITE WHITELIST</b>";

                    } else if (status.cooldown) {

                        wlCard.style.borderTop = "2px solid #ff1744";

                        wlText.innerHTML = `⛔ <b>ATMESTA.</b> Bandykite už ${status.timeLeft} val.`;

                    } else {

                        wlText.innerText = "Norėdamas žaisti, privalai užpildyti anketą.";

                        wlBtn.style.display = "inline-block";

                    }



                } catch (e) { 

                    console.error("Klaida:", e); 

                    // Jei nepavyksta prisijungti prie VPS, nerodome klaidos vartotojui, tiesiog neuzkraunam dashboard

                }

            }

            // Slepiam loaderį

            setTimeout(() => document.getElementById('preloader').classList.add('hidden'), 800);

        }



        async function submitForm(e) {

            e.preventDefault();

            const btn = e.target.querySelector('button');

            const originalText = btn.innerText;

            btn.innerText = "Siunčiama...";

            btn.disabled = true;

            

            const payload = {

                discordId: currentUser.id,

                discordName: currentUser.username,

                answers: {

                    age: document.getElementById('q1').value,

                    history: document.getElementById('q2').value,

                    nlr: document.getElementById('q3').value,

                    fearrp: document.getElementById('q4').value,

                    why: document.getElementById('q5').value

                }

            };



            try {

                const res = await fetch(`${API_URL}/submit-app`, {

                    method: 'POST',

                    headers: {'Content-Type': 'application/json'},

                    body: JSON.stringify(payload)

                });

                const data = await res.json();

                

                if (data.success) {

                    alert("Anketa išsiųsta! Laukite patvirtinimo.");

                    window.location.reload();

                } else {

                    alert("Klaida siunčiant.");

                }

            } catch (e) { alert("Nepavyko susisiekti su serveriu."); }

            

            btn.innerText = originalText;

            btn.disabled = false;

        }



        async function loadApps(adminId) {

            try {

                const res = await fetch(`${API_URL}/get-apps?adminId=${adminId}`);

                const apps = await res.json();

                const list = document.getElementById('applications-list');

                

                if(apps.length === 0) { list.innerHTML = "<p style='color:#888; text-align:center;'>Nėra naujų anketų.</p>"; return; }



                list.innerHTML = apps.map(app => `

                    <div class="admin-app-card" id="app-${app.id}">

                        <div class="admin-app-header">

                            <h3>${app.discordName} <span style="font-size:0.8rem; color:#666;">(${app.discordId})</span></h3>

                            <small>${new Date(parseInt(app.id)).toLocaleTimeString()}</small>

                        </div>

                        <div class="admin-app-grid">

                            <div class="admin-answer-box"><span class="admin-answer-label">Amžius</span>${app.answers.age}</div>

                            <div class="admin-answer-box"><span class="admin-answer-label">Istorija</span>${app.answers.history}</div>

                            <div class="admin-answer-box"><span class="admin-answer-label">NLR</span>${app.answers.nlr}</div>

                            <div class="admin-answer-box"><span class="admin-answer-label">FearRP</span>${app.answers.fearrp}</div>

                            <div class="admin-answer-box" style="grid-column: span 2;"><span class="admin-answer-label">Kodėl mes?</span>${app.answers.why}</div>

                        </div>

                        <div class="admin-actions">

                            <button class="toggle-btn" style="background:#00e676; border:none; color:black;" onclick="handle('${app.id}', 'approve')">PRIIMTI</button>

                            <button class="toggle-btn" style="background:#ff1744; border:none;" onclick="handle('${app.id}', 'reject')">ATMESTI</button>

                        </div>

                    </div>

                `).join('');

            } catch(e) { console.error(e); }

        }



        async function handle(id, action) {

            if(!confirm("Ar tikrai?")) return;

            const res = await fetch(`${API_URL}/handle-app`, {

                method: 'POST',

                headers: {'Content-Type': 'application/json'},

                body: JSON.stringify({ adminId: currentUser.id, appId: id, action })

            });

            const data = await res.json();

            alert(data.msg);

            if(data.success) document.getElementById(`app-${id}`).remove();

        }



        init();

    </script>

</body>

</html>
