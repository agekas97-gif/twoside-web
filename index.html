<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagrindinis Puslapis</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; }
        
        /* Admin mygtukas viršuje kairėje (Pagal nutylėjimą paslėptas) */
        #admin-btn {
            display: none; /* Paslėpta */
            position: fixed;
            top: 15px;
            left: 15px;
            background-color: #ff9800;
            color: white;
            padding: 10px 15px;
            text-decoration: none;
            font-weight: bold;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        #admin-btn:hover { background-color: #e68a00; }

        /* Paprastas prisijungimo mygtukas apačioje */
        #login-btn {
            position: fixed;
            bottom: 15px;
            right: 15px;
            background: #333;
            color: white;
            border: none;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 4px;
        }
    </style>
</head>
<body>

    <a href="admin.html" id="admin-btn">⚙️ Admin Panel</a>

    <h1 style="text-align: center; margin-top: 50px;">Sveiki atvykę į projektą!</h1>
    <p style="text-align: center;">Čia tavo pagrindinės svetainės turinys...</p>

    <button id="login-btn" onclick="askForId()">Prisijungti (Darbuotojams)</button>

    <script>
        // TAVO BACKEND URL (Pakeisk į tikrąjį, kai įkelsi serverį, pvz. https://tavo-botas.onrender.com)
        const BACKEND_URL = 'http://localhost:3000';

        // Funkcija, kuri patikrina, ar išsaugotas ID turi rolę
        async function checkRole() {
            const myId = localStorage.getItem('discordId');
            if (!myId) return; // Jei nėra ID, nieko nedarom

            try {
                const res = await fetch(`${BACKEND_URL}/check-teamlead?id=${myId}`);
                const data = await res.json();

                if (data.isLead) {
                    // Jei jis Team Lead, parodome mygtuką ir paslepiame login mygtuką
                    document.getElementById('admin-btn').style.display = 'block';
                    document.getElementById('login-btn').style.display = 'none';
                }
            } catch (e) {
                console.error("Klaida tikrinant rolę:", e);
            }
        }

        // Funkcija paprašyti ID
        function askForId() {
            const id = prompt("Įveskite savo Discord ID (Skaičiai):");
            if (id) {
                localStorage.setItem('discordId', id); // Išsaugome naršyklėje
                checkRole(); // Patikriname rolę iškart
                alert("ID išsaugotas! Jei turite teises, viršuje atsiras mygtukas.");
            }
        }

        // Kai puslapis užsikrauna, automatiškai patikriname, ar jau turime išsaugotą ID
        window.onload = checkRole;
    </script>
</body>
</html>
